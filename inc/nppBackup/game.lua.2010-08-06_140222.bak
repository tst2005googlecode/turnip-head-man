

player = {
	facing = 'right',
	jumping = false,
	x = 100,
	y = 100,
}

game = {state = 'newGame'}

local backgrounds = {}



---------------------------------------------------------------------------------------------------------
------------------------------------------Game Functions-----------------------------------------------
---------------------------------------------------------------------------------------------------------

function game:run() --calls the game state 
	game[game.state]()
end

function game:running() --is run when the game is `running`
	player:update()
	game:backgrounds()
end

function game:backgrounds()
	for i,v in pairs(backgrounds) do
		love.graphics.draw(v.image,v.x,v.y)
	end
end

function game:start() --called when you start a game
	
end

function game:newGame() --called when you start a NEW game
	player.left = newImageAnimation('img/player/left/', 0.08, 9)
	player.right =  newImageAnimation('img/player/right/', 0.08, 9)
	table.insert(backgrounds,{image = love.graphics.newImage('img/map1.png'), collide = true, collisionMap = collision:newCollisionMap('img/map1.png'), x=0,y=0,})
	game.state = 'running'
end

function game:loadGame() --called when you start LOAD a game
	
end

function game:paused()
	
end









---------------------------------------------------------------------------------------------------------
------------------------------------------Player Functions-----------------------------------------------
---------------------------------------------------------------------------------------------------------


function player:gravity()
	--collision:checkCollision( sprite1, sprite2 )
end

function player:jumping()
	--collision:checkCollision( sprite1, sprite2 )
end

function player:die()
	error('nawwww....')
end

function player:update(dt)
	player.sprite():update(dt)
	player:isColliding()
	player:gravity()
	player:jumping()
	player:walking()
	player:draw()
end

function player:walking()
	
	local mathDelta = math.ceil(140 * dt)

	if love.keyboard.isDown( 'left') then
       player.x = math.ceil(player.x - mathDelta)
	   player.facing = 'left'
    end

    if love.keyboard.isDown('right') then
		player.x = math.ceil(player.x + mathDelta)
		player.facing = 'right'
    end

    if love.keyboard.isDown('up') then
       player.y = math.ceil(player.y - mathDelta)
    end

    if love.keyboard.isDown('down') then
       player.y = math.ceil(player.y + mathDelta)
    end
	
	if not love.keyboard.isDown('down') and not love.keyboard.isDown('up') and not love.keyboard.isDown('right') and love.keyboard.isDown( 'left') then
		player:sprite():toggle()
		player:sprite():reset()
	end
	
	debugVal = player:isColliding()
end

function player:draw()
	 player:sprite():draw(player.x, player.y, 0,1,1,0,0)
end

function player:isColliding()
	local sprite1 = player:sprite():getImage()
	sprite1.x = player.x
	sprite1.y = player.y
		
	return collision:checkCollision( sprite1, backgrounds[1] )
end

function player:sprite()
	return player[player.facing]
end














